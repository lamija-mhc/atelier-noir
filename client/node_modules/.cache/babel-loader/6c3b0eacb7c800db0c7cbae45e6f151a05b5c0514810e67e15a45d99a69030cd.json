{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Korpa=()=>{const[proizvodi,setProizvodi]=useState([]);const[greska,setGreska]=useState(\"\");const[loading,setLoading]=useState(true);const email=localStorage.getItem(\"userEmail\");const navigate=useNavigate();const fetchCart=()=>{fetch(\"http://localhost:5000/api/cart/\".concat(email)).then(res=>res.json()).then(data=>{if(data.error){setGreska(data.error);setProizvodi([]);}else if(data.proizvodi&&Array.isArray(data.proizvodi)){setProizvodi(data.proizvodi);setGreska(\"\");}else{setGreska(\"Neočekivan odgovor sa servera.\");setProizvodi([]);}}).catch(()=>{setGreska(\"Greška pri povezivanju sa serverom.\");});};useEffect(()=>{if(!email){setLoading(false);setGreska(\"Morate biti prijavljeni da biste vidjeli korpu.\");return;}fetchCart();setLoading(false);},[email]);const handleDelete=id=>{console.log(\"Brisanje proizvoda sa id:\",id);fetch(\"http://localhost:5000/api/cart/\".concat(email,\"/\").concat(id),{method:\"DELETE\"}).then(res=>res.json()).then(data=>{console.log(\"Odgovor backend-a:\",data);if(data.success){fetchCart();// ponovo učitaj korpu\n}else{alert(\"Brisanje nije uspjelo.\");}}).catch(err=>{console.error(\"Greška pri brisanju:\",err);});};const handleCheckout=()=>{navigate(\"/thank-you\");};// Izračun ukupne cijene\nconst ukupno=proizvodi.reduce((sum,p)=>{const cijenaBroj=parseFloat(p.cijena.replace(\"$\",\"\"));return sum+cijenaBroj*(p.kolicina||1);},0);if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"U\\u010Ditavanje korpe...\"});if(greska)return/*#__PURE__*/_jsx(\"p\",{style:{color:\"red\"},children:greska});return/*#__PURE__*/_jsxs(\"div\",{className:\"korpa-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Korpa\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"korpa-lista\",children:proizvodi.length===0?/*#__PURE__*/_jsx(\"li\",{children:\"Korpa je prazna\"}):proizvodi.map(p=>/*#__PURE__*/_jsxs(\"li\",{className:\"korpa-stavka\",children:[/*#__PURE__*/_jsx(\"img\",{src:p.slika,alt:p.naziv,className:\"korpa-slika\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"korpa-info\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[p.naziv,\" x \",p.kolicina]}),/*#__PURE__*/_jsxs(\"p\",{className:\"cijena\",children:[\"$\",(parseFloat(p.cijena.replace(\"$\",\"\"))*(p.kolicina||1)).toFixed(2)]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-btn\",onClick:()=>handleDelete(p.id),children:\"\\u2716\"})]},p.id))}),proizvodi.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ukupno\",children:[\"Ukupno: $\",ukupno.toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{className:\"checkout-dugme\",onClick:handleCheckout,children:\"Nastavi na pla\\u0107anje\"})]})]});};export default Korpa;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Korpa","proizvodi","setProizvodi","greska","setGreska","loading","setLoading","email","localStorage","getItem","navigate","fetchCart","fetch","concat","then","res","json","data","error","Array","isArray","catch","handleDelete","id","console","log","method","success","alert","err","handleCheckout","ukupno","reduce","sum","p","cijenaBroj","parseFloat","cijena","replace","kolicina","children","style","color","className","length","map","src","slika","alt","naziv","toFixed","onClick"],"sources":["C:/Users/muki_/Desktop/atelier-noir/client/src/pages/korpa.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst Korpa = () => {\r\n  const [proizvodi, setProizvodi] = useState([]);\r\n  const [greska, setGreska] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n  const email = localStorage.getItem(\"userEmail\");\r\n  const navigate = useNavigate();\r\n\r\n  const fetchCart = () => {\r\n    fetch(`http://localhost:5000/api/cart/${email}`)\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        if (data.error) {\r\n          setGreska(data.error);\r\n          setProizvodi([]);\r\n        } else if (data.proizvodi && Array.isArray(data.proizvodi)) {\r\n          setProizvodi(data.proizvodi);\r\n          setGreska(\"\");\r\n        } else {\r\n          setGreska(\"Neočekivan odgovor sa servera.\");\r\n          setProizvodi([]);\r\n        }\r\n      })\r\n      .catch(() => {\r\n        setGreska(\"Greška pri povezivanju sa serverom.\");\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!email) {\r\n      setLoading(false);\r\n      setGreska(\"Morate biti prijavljeni da biste vidjeli korpu.\");\r\n      return;\r\n    }\r\n    fetchCart();\r\n    setLoading(false);\r\n  }, [email]);\r\n\r\n  const handleDelete = (id) => {\r\n    console.log(\"Brisanje proizvoda sa id:\", id);\r\n    fetch(`http://localhost:5000/api/cart/${email}/${id}`, {\r\n      method: \"DELETE\",\r\n    })\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        console.log(\"Odgovor backend-a:\", data);\r\n        if (data.success) {\r\n          fetchCart(); // ponovo učitaj korpu\r\n        } else {\r\n          alert(\"Brisanje nije uspjelo.\");\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        console.error(\"Greška pri brisanju:\", err);\r\n      });\r\n  };\r\n\r\n  const handleCheckout = () => {\r\n    navigate(\"/thank-you\");\r\n  };\r\n\r\n  // Izračun ukupne cijene\r\n  const ukupno = proizvodi.reduce((sum, p) => {\r\n    const cijenaBroj = parseFloat(p.cijena.replace(\"$\", \"\"));\r\n    return sum + cijenaBroj * (p.kolicina || 1);\r\n  }, 0);\r\n\r\n  if (loading) return <p>Učitavanje korpe...</p>;\r\n  if (greska) return <p style={{ color: \"red\" }}>{greska}</p>;\r\n\r\n  return (\r\n    <div className=\"korpa-container\">\r\n      <h2>Korpa</h2>\r\n      <ul className=\"korpa-lista\">\r\n        {proizvodi.length === 0 ? (\r\n          <li>Korpa je prazna</li>\r\n        ) : (\r\n          proizvodi.map((p) => (\r\n            <li key={p.id} className=\"korpa-stavka\">\r\n              <img src={p.slika} alt={p.naziv} className=\"korpa-slika\" />\r\n              <div className=\"korpa-info\">\r\n                <p>\r\n                  {p.naziv} x {p.kolicina}\r\n                </p>\r\n                <p className=\"cijena\">\r\n                  $\r\n                  {(parseFloat(p.cijena.replace(\"$\", \"\")) * (p.kolicina || 1)).toFixed(2)}\r\n                </p>\r\n              </div>\r\n              <button className=\"delete-btn\" onClick={() => handleDelete(p.id)}>\r\n                ✖\r\n              </button>\r\n            </li>\r\n          ))\r\n        )}\r\n      </ul>\r\n\r\n      {proizvodi.length > 0 && (\r\n        <>\r\n          <div className=\"ukupno\">Ukupno: ${ukupno.toFixed(2)}</div>\r\n          <button className=\"checkout-dugme\" onClick={handleCheckout}>\r\n            Nastavi na plaćanje\r\n          </button>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Korpa;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}